<!DOCTYPE HTML>
<html>
<head>
<meta charset='utf-8' />
<title>БД и таблицы расходов бюджета Санкт-Петербурга из разных источников</title>
<link rel='stylesheet' href='main.css' />
</head>
<body>
<nav><ul><li><a href='.'>Главная</a></li><li><a href='xls.html'>Таблицы расходов из pdf</a></li><li class='active'>БД расходов из разных источников</li><li><a href='fincom.html'>Что есть на сайте Комитета</a></li></ul></nav>
<p>Если вы не программист, то вам, скорее всего, нужен один из этих двух файлов:</p>
<dl class='downloads'>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AAD748tUHyg_ygvg33KyRELYa/db/departments.xlsx' class='file'>departments.xlsx</a></code></dt><dd>Ведомственная структура расходов бюджета Санкт-Петербурга</dd>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AABR26YSyjmhg0FxQeRfYkzUa/db/sections.xlsx' class='file'>sections.xlsx</a></code></dt><dd>Распределение бюджетных ассигнований бюджета Санкт-Петербурга</dd>
</dl>
<p>В каждом из этих файлов данные на 2014 год и на плановый период 2015 и 2016 годов, а также данные проектов, поправок и принятых законов объединены в одну таблицу со сворачивающимися уровнями. Далее приводится информация для тех, кто хочет получить подобные файлы самостоятельно или использовать данные, применявшиеся для их получения, иным способом.</p>
<h1>База данных и таблицы расходов бюджета Санкт-Петербурга</h1>
<p>Данные, использованные для построения базы, прошли несколько уровней обработки. Эти уровни пронумерованы так, что на каждом из них в качестве исходных данных используются только данные непосредственно предшествующего уровня. Список уровней:</p>
<dl>
<dt><code><a href='#1-sources'>1-sources</a></code></dt><dd>исходные данные — документы с различных сайтов</dd></dd>
<dt><code><a href='#2-tables'>2-tables</a></code></dt><dd>таблицы, извлечённые из документов</dd></dd>
<dt><code><a href='#3-db'>3-db</a></code></dt><dd>база данных, полученная из таблиц</dd></dd>
<dt><code><a href='#4-xls'>4-xls</a></code></dt><dd>первый вариант отчётов из базы данных — <abbr title='Excel Binary File Format, бинарный формат файлов Excel'>xls</abbr>- и <abbr title='Excel 2007 workbook'>xlsx</abbr>-файлы</dd></dd>
<dt><code><a href='#4-xlsx'>4-xlsx</a></code></dt><dd>второй, рекомендуемый вариант отчётов из базы данных — только <abbr title='Excel 2007 workbook'>xlsx</abbr>-файлы</dd></dd>
</dl>
<p>Так как промежуточные данные тоже представляют интерес, здесь приводятся результаты каждого этапа. На данный момент собраны данные для 2014 года.</p>
<h2 id='1-sources'>Исходные данные</h2><p>Исходными данными являются документы в том виде, в котором они были опубликованы на	официальных сайтах. Документы взяты из следующих источников:</p>
<ul>
<li>Раздел <a href='http://www.fincom.spb.ru/comfin/budjet/budget_for_people.htm' class='external'>«Бюджет для граждан»</a> сайта <a href='http://www.fincom.spb.ru/' class='external'>Комитета финансов Санкт-Петербурга</a>, откуда использованы <abbr title='Excel 2007 workbook'>xlsx</abbr>-файлы для таблиц расходов бюджета. Это позволяет установить, какими планировались расходы до рассмотрения в Законодательном Собрании, и какими они стали после. К сожалению, эти данные не полны.</li>
<li><a href='xls.html'>Проект по извлечению таблиц из <abbr title='Portable Document Format'>pdf</abbr>-файлов</a>, откуда берутся таблицы в формате <abbr title='comma-separated values, значения, разделённые запятыми'>csv</abbr> для недостающих данных «Бюджета для граждан».</li>
<li>Сайт <a href='http://assembly.spb.ru/' class='external'>Законодательного Собрания Санкт-Петербурга</a>, откуда берутся документы с поправками к бюджету. Это позволяет проследить, как менялись расходы бюджета при рассмотрении в <abbr title='Законодательном Собрании'>ЗС</abbr>. Полученные документы были вручную преобразованы в формат <abbr title='OpenDocument Text'>odt</abbr>. Короткие поправки в исходные данные не включены, они введены вручную и добавляются на следующем уровне.</li>
</ul>
<dl class='downloads'>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AAD70JC3eQ6mKFNqgUcFh8o7a/db/1-sources.out.zip' class='file'>1-sources.out.zip</a></code></dt><dd>архив с документами</dd>
</dl>
<h2 id='2-tables'>Таблицы из исходных документов</h2><p>На этом уровне формируются <abbr title='comma-separated values, значения, разделённые запятыми'>csv</abbr>-таблицы, из которых далее можно будет собрать базу данных. Первая строка каждого <abbr title='comma-separated values, значения, разделённые запятыми'>csv</abbr>-файла содержит названия столбцов. Таблицы размещены в двух каталогах:</p>
<dl>
<dt><code>content</code></dt><dd>Собственно таблицы из документов. В основном это таблицы с изменениями ведомственной структуры расходов бюджета.</dd>
<dt><code>meta</code></dt><dd>Таблицы с данными о самих документах.</dd>
</dl>
<p>Файлы каталога <code>content</code> содержат часть информации в своих именах (<code><em>filename</em></code>):</p>
<pre>
<code><em>filename</em> ::= <em>year</em> "." <em>documentNumber</em> "." <em>paragraphNumber</em> "." <em>tableType</em> "." <em>operationType</em> [ "(" <em>operationArguments</em> ")" ] ".csv"</code>
<code><em>year</em> ::= <em>число</em></code>
<code><em>documentNumber</em> ::= <em>число</em></code>
<code><em>paragraphNumber</em> ::= <em>число</em> { "." <em>число</em> }</code>
<code><em>tableType</em> ::= <em>строка</em></code>
<code><em>operationType</em> ::= <em>строка</em></code>
<code><em>operationArguments</em> ::= <em>число</em> { "," <em>число</em> }</code>
</pre>
<p>Здесь <code><em>число</em></code> — последовательность из одной или более цифр, а <code><em>строка</em></code> — последовательность из одной или более строчных латинских букв.</p>
<p>Описания элементов имён файлов:</p>
<dl>
<dt><code><em>year</em></code></dt><dd>основной год, для которого рассматривается бюджет (пока всегда 2014); не является годом планового периода</dd>
<dt><code><em>documentNumber</em></code></dt><dd>номер документа в <abbr title='Законодательном Собрании'>ЗС</abbr></dd>
<dt><code><em>paragraphNumber</em></code></dt><dd>номер приложения или пункта в документе</dd>
<dt><code><em>tableType</em></code></dt><dd>тип таблицы из документа, это может быть:<dl><dt><code>department</code></dt><dd>распределение расходов по комитетам и целевым статьям</dd><dt><code>section</code></dt><dd>распределение тех же расходов по разделам, приводится не для всех документов</dd></dl></dd>
</dl>
<p>Далее рассматриваются форматы отдельных файлов.</p>
<dl>
<dt id='2-tables-meta-authors'><code>meta/authors.csv</code></dt><dd>Авторы, которые внесли в <abbr title='Законодательное Собрание'>ЗС</abbr> какой-либо документ или поправку. Столбцы:<dl><dt><code>authorId</code></dt><dd>числовой идентификатор автора для связи с <a href='#2-tables-meta-documents'>таблицей документов</a></dd><dt><code>authorShortName</code></dt><dd>короткое имя автора для написания в узких столбцах таблиц документов, получаемых на последнем уровне</dd><dt><code>authorLongName</code></dt><dd>имя автора в том виде, в котором оно указано на сайте <abbr title='Законодательного Собрания'>ЗС</abbr></dd></dl></dd>
<dt id='2-tables-meta-documents'><code>meta/documents.csv</code></dt><dd>Документы — проекты законов и поправки. Столбцы:<dl><dt><code>documentNumber</code></dt><dd>номер документа в <abbr title='Законодательном Собрании'>ЗС</abbr></dd><dt><code>documentDate</code></dt><dd>дата внесения документа в расширенном формате ISO (YYYY-MM-DD)</dd><dt><code>stageNumber</code></dt><dd>номер варианта закона (0 — первоначальный закон, 1 — первая корректировка, 2 — вторая и т.д.) для связи с <a href='#2-tables-meta-stages'>таблицей вариантов законов</a></dd><dt><code>amendmentFlag</code></dt><dd>тип проекта/поправки (0 — проект, после которого идут 1 — отдельно внесённые поправки, затем 2 — прочие изменения, приводящие проект закона к конечному виду, в котором он принимается)</dd><dt><code>authorId</code></dt><dd>числовой идентификатор автора (если автор известен, для amendmentFlag=2 считается неизвестным)</dd><dt><code>documentAssemblyUrl</code></dt><dd>ссылка на документ на сайте <abbr title='Законодательного Собрания'>ЗС</abbr>, содержащий данные (если он там опубликован)</dd></dl></dd>
<dt id='2-tables-meta-stages'><code>meta/stages.csv</code></dt><dd>Варианты законов (на данный момент — одного закона 2014 года). Столбцы:<dl><dt><code>stageNumber</code></dt><dd>номер варианта закона</dd><dt><code>stageAssemblyUrl</code></dt><dd>ссылка на страницу с документами, поступившими в <abbr title='Законодательное Собрание'>ЗС</abbr> во время рассмотрения проекта этого варианта</dd></dl></dd>
</dl>
<dl class='downloads'>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AAD1OOiMH3bkWrcSJRxYgGaTa/db/2-tables.out.zip' class='file'>2-tables.out.zip</a></code></dt><dd>архив с таблицами</dd>
</dl>
<h2 id='3-db'>База данных</h2>
<dl class='downloads'>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AAAqZSkbCAq0QiXNx7SRcamxa/db/db.sql' class='file'>db.sql</a></code></dt><dd>база данных в формате <abbr title='Structured Query Language, структурированный язык запросов'>sql</abbr> для <abbr title='системы управления базами данных'>СУБД</abbr> <a href='http://www.sqlite.org/' class='external'>SQLite</a></dd>
</dl>
<h2 id='4-xls'>Первый вариант отчётов</h2>
<p>Данные извлечены в <abbr title='Excel Binary File Format, бинарный формат файлов Excel'>xls</abbr> и <abbr title='Excel 2007 workbook'>xlsx</abbr>-таблицы для просмотра.</p>
<dl class='downloads'>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AACSIvNR2yyKqoqX_jzY_stia/db/4-xls.out.zip' class='file'>4-xls.out.zip</a></code></dt><dd>архив с таблицами</dd>
</dl>
<h2 id='4-xlsx'>Второй вариант отчётов</h2>
<dl class='downloads'>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AAD748tUHyg_ygvg33KyRELYa/db/departments.xlsx' class='file'>departments.xlsx</a></code></dt><dd>Ведомственная структура расходов бюджета Санкт-Петербурга</dd>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AABR26YSyjmhg0FxQeRfYkzUa/db/sections.xlsx' class='file'>sections.xlsx</a></code></dt><dd>Распределение бюджетных ассигнований бюджета Санкт-Петербурга</dd>
</dl>
<h2>Предыдущие версии файлов</h2>
<dl class='downloads'>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AABhPMABJXrqZLNhidiZX0VJa/db/db.v1.zip' class='file'>db.v1.zip</a></code></dt><dd>выпуск к принятию первоначального варианта закона о бюджете 2014 года</dd>
<dt><code><a href='https://dl.dropboxusercontent.com/sh/zgnevck3cij1gm0/AADtnbKci8NHgsdWFSCiEM3da/db/db.v2.zip' class='file'>db.v2.zip</a></code></dt><dd>выпуск к принятию первой корректировки закона о бюджете 2014 года</dd>
</dl>
<p><a href='https://www.dropbox.com/sh/zgnevck3cij1gm0/AABdfNdrzoimxiWDe_DDPfpCa/db' class='external'>Ссылка на папку dropbox</a> (на случай, если они поменяют ссылки).</p>
</body>
</html>
